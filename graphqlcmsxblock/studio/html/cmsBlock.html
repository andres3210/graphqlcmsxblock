<div class="myxblock_block">
    <h2>CMS Content Block</h2>

    <div>
        <label>Select Course:</label><br />
        <select id="courseFilter" style="width: 400px;">
            <option value="">All CourseTags</option>
            {% for tag in courseTags %}
                <option value="{{ tag.slug }}" {% if selectedCourseTag == tag.slug %} selected="selected" {% endif %}>{{tag.title}}</option>
            {% endfor %}        
        </select>
    </div>

    <br /><br />

    <div>
        <label>Select Entry:</label><br />
        <select id="entry"  style="width:400px;">
            <option value="">Please select...</option>
            <optgroup label="Clauses" id="clausesOptions">      </optgroup>
            <optgroup label="Courses" id="coursesOptions"></optgroup>
            <optgroup label="Sections" id="sectionsOptions"></optgroup>
            <optgroup label="Units" id="unitsOptions"></optgroup>
        </select>
    </div>

    <script>
        // Current entry
        var entrySlug = '{{ self.entrySlug }}';
        var entryType = '{{ self.entryType }}';
        var blockOder = {{ blockOrder | safe }}

        // CMS Lists
        var clauses = {{ clausesList | safe }};
        var sections = {{ sectionsList | safe }};
        var courses = {{ coursesList | safe }};
        var units = {{ unitsList | safe }};
    </script>    
</div>

<form entry-type="{{ self.entryType }}" onChange="updateSelection(this)" onsubmit="javascript:void(0);">
<ul id="generalView">
        
    {% for identifier, section in sections.items %}
        <li data-id="{{ identifier }}" >
            <div style="padding: 0.8em; margin: 0.5em; background: lightgray; border-radius: 7px;">
                <label><input 
                    type="checkbox" 
                    name="{{ identifier  }}"
                    {% if identifier in entrySections %}checked="checked"{% endif %}
                    > Include {{ identifier }}</label>
                <p>{{ section | safe }}</p>
            </div>
        </li>
    {% endfor %}

    {% for block in contentBlocks %}
        {% with identifier="contentBlock["|add:block.id|add:"]" %}
        <li data-id="{{ identifier }}">
            <div style="padding: 0.8em; margin: 0.5em; background: lightgray; border-radius: 7px;">
                <label><input 
                    type="checkbox" 
                    name="{{ identifier }}"
                    {% if identifier in entrySections %}checked="checked"{% endif %}
                    > Include Content Block</label> 
                {% if block.cssClass == None %}
                    {% if block.blockTitle != null %}
                        <h5>{{ block.blockTitle }}</h5>
                    {% endif %}
                    <div>{{ block.blockContent | safe }}</div>
                {% elif block.cssClass == 'edx-academy-tip' %}
                    <div class="edx-academy-tip">
                        {% for image in block.componentIcon %}
                            <div class="edx-icon">
                                <img src="{{ cmsHost }}{{ image.url }}" class="img-fluid"/>
                            </div>
                        {% endfor %}
                        <div class="edx-content">
                            {{ block.blockContent | safe }}
                        </div>
                    </div>
                {% elif block.cssClass == 'edx-featured-content' %}
                    <div class="edx-featured-content">
                        {% for image in block.componentIcon %}
                            <div class="edx-icon">
                                <img src="{{ cmsHost }}{{ image.url }}" class="img-fluid"/>
                            </div>
                        {% endfor %}
                        <div class="edx-content">
                            {{ block.blockContent | safe }}
                        </div>
                    </div>
                {% elif block.cssClass == 'edx-advanced-concept' %}
                    <div class="edx-advanced-concept">
                        <button class="edx-opener">
                            <span>Close</span>
                            <em>Open</em>
                        </button>
                        <strong class="edx-heading">Advanced Concept</strong>
                        <div class="edx-content">
                            {{ block.blockContent | safe }}
                        </div>
                    </div>
                {% endif %}
            </div>
        </li>
        {% endwith %}
    {% endfor %}

    {% for asset in assets %}
        {% for file in asset.assetfile %}
            {% with identifier="cmsAsset["|add:file.id|add:"]" %}
            <li data-id="{{ identifier }}">
                <div style="padding: 0.8em; margin: 0.5em; background: lightgray; border-radius: 7px;">
                    <label><input 
                        type ="checkbox" 
                        name="{{ identifier }}"
                        {% if identifier in entrySections %}checked="checked"{% endif %}
                        > Include Cms Asset</label>
                    <img src="{{ cmsHost }}{{ file.url }}" class="img-fluid {{ asset.assetType }}"/>
                </div>
            </li>
            {% endwith %}
        {% endfor %}
    {% endfor %}

    {% for faq in faqs %}
        {% with identifier="faq["|add:faq.id|add:"]" %}
        <li data-id="{{ identifier }}">
            <div style="padding: 0.8em; margin: 0.5em; background: lightgray; border-radius: 7px;">
                <label><input 
                    type="checkbox" 
                    name="{{ identifier }}"
                    {% if identifier in entrySections %}checked="checked"{% endif %}
                    > Include FAQ</label>
                <h5>{{ faq.question }}</h5>
                <div>{{ faq.answer | safe }}</div>
            </div>
        </li>
        {% endwith %}
    {% endfor %}

    {% for tip in tips %}
        {% with identifier="tip["|add:tip.id|add:"]" %}
        <li data-id="{{ identifier }}">
            <div style="padding: 0.8em; margin: 0.5em; background: lightgray; border-radius: 7px;" class = "{{ tip.tipCssClass }}">
                <label><input 
                    type="checkbox" 
                    name="{{ identifier }}"
                    {% if identifier in entrySections %}checked="checked"{% endif %}
                    > Include Tip</label>
                <h5>{{ tip.tipTitle }}</h5>
                <div>{{ tip.tipContent | safe }}</div>
            </div>
        </li>
        {% endwith %}
    {% endfor %}

    {% for table in tables2 %}
        {% with identifier="table2colMatrix["|add:table.id|add:"]" %}
        <li data-id="{{ identifier }}">
            <div style="padding: 0.8em; margin: 0.5em; background: lightgray; border-radius: 7px;">
                <label><input 
                    type="checkbox" 
                    name="{{ identifier }}"
                    {% if identifier in entrySections %}checked="checked"{% endif %}
                    > Include Table</label>
                <table>
                    {% if table.hasHeaderRow.0 == 'yes' %}
                        <tr>
                            <th> {{ table.table2col.0.col1 | safe }} </th>
                            <th> {{ table.table2col.0.col2 | safe }} </th>
                        </tr>
                        {% for row in table.table2col|slice:"1:" %}
                            <tr>
                                <td> {{ row.col1 | safe }} </td>
                                <td> {{ row.col2 | safe }} </td>
                            </tr>
                        {% endfor %}
                    {% else %}
                        {% for row in table.table2col %}
                            <tr>
                                <td> {{ row.col1 | safe }} </td>
                                <td> {{ row.col2 | safe }} </td>
                            </tr>
                        {% endfor %}
                    {% endif %}
                </table>
            </div>
        </li>
        {% endwith %}
    {% endfor %}

    {% for table in tables3 %}
        {% with identifier="table3colMatrix["|add:table.id|add:"]" %}
        <li data-id="{{ identifier }}">
            <div style="padding: 0.8em; margin: 0.5em; background: lightgray; border-radius: 7px;">
                <label><input 
                    type ="checkbox" 
                    name="{{ identifier }}"
                    {% if identifier in entrySections %}checked="checked"{% endif %}
                    > Include Table</label>
                <table>
                    {% if table.hasHeaderRow.0 == 'yes' %}
                        <tr>
                            <th> {{ table.table3col.0.col1 | safe }} </th>
                            <th> {{ table.table3col.0.col2 | safe }} </th>
                            <th> {{ table.table3col.0.col3 | safe }} </th>
                        </tr>
                        {% for row in table.table3col|slice:"1:" %}
                            <tr>
                                <td> {{ row.col1 | safe }} </td>
                                <td> {{ row.col2 | safe }} </td>
                                <td> {{ row.col3 | safe }} </td>
                            </tr>
                        {% endfor %}
                    {% else %}
                        {% for row in table.table3col %}
                            <tr>
                                <td> {{ row.col1 | safe }} </td>
                                <td> {{ row.col2 | safe }} </td>
                                <td> {{ row.col3 | safe }} </td>
                            </tr>
                        {% endfor %}
                    {% endif %}
                </table>
            </div>
        </li>
        {% endwith %}
    {% endfor %}

    {% for table in tables4 %}
        {% with identifier="table4colMatrix["|add:table.id|add:"]" %}
        <li data-id="{{ identifier }}">
            <div style="padding: 0.8em; margin: 0.5em; background: lightgray; border-radius: 7px;">
                <label><input 
                    type="checkbox" 
                    name="{{ identifier }}"
                    {% if identifier in entrySections %}checked="checked"{% endif %}
                    > Include Table</label>
                <table>
                    {% if table.hasHeaderRow.0 == 'yes' %}
                        <tr>
                            <th> {{ table.table4col.0.col1 | safe }} </th>
                            <th> {{ table.table4col.0.col2 | safe }} </th>
                            <th> {{ table.table4col.0.col3 | safe }} </th>
                            <th> {{ table.table4col.0.col4 | safe }} </th>
                        </tr>
                        {% for row in table.table4col|slice:"1:" %}
                            <tr>
                                <td> {{ row.col1 | safe }} </td>
                                <td> {{ row.col2 | safe }} </td>
                                <td> {{ row.col3 | safe }} </td>
                                <td> {{ row.col4 | safe }} </td>
                            </tr>
                        {% endfor %}
                    {% else %}
                        {% for row in table.table4col %}
                            <tr>
                                <td> {{ row.col1 | safe }} </td>
                                <td> {{ row.col2 | safe }} </td>
                                <td> {{ row.col3 | safe }} </td>
                                <td> {{ row.col4 | safe }} </td>
                            </tr>
                        {% endfor %}
                    {% endif %}
                </table>
            </div>
        </li>
        {% endwith %}
    {% endfor %}

    {% for table in tables5 %}
        {% with identifier="table5colMatrix["|add:table.id|add:"]" %}
        <li data-id="{{ identifier }}">
            <div style="padding: 0.8em; margin: 0.5em; background: lightgray; border-radius: 7px;">
                <label><input 
                    type ="checkbox" 
                    name = "{{ identifier }}"
                    {% if identifier in entrySections %}checked="checked"{% endif %}
                    > Include Table</label>
                <table>
                    {% if table.hasHeaderRow.0 == 'yes' %}
                        <tr>
                            <th> {{ table.table4col.0.col1 | safe }} </th>
                            <th> {{ table.table4col.0.col2 | safe }} </th>
                            <th> {{ table.table4col.0.col3 | safe }} </th>
                            <th> {{ table.table4col.0.col4 | safe }} </th>
                            <th> {{ table.table4col.0.col5 | safe }} </th>
                        </tr>
                        {% for row in table.table5col|slice:"1:" %}
                            <tr>
                                <td> {{ row.col1 | safe }} </td>
                                <td> {{ row.col2 | safe }} </td>
                                <td> {{ row.col3 | safe }} </td>
                                <td> {{ row.col4 | safe }} </td>
                                <td> {{ row.col5 | safe }} </td>
                            </tr>
                        {% endfor %}
                    {% else %}
                        {% for row in table.table5col %}
                            <tr>
                                <td> {{ row.col1 | safe }} </td>
                                <td> {{ row.col2 | safe }} </td>
                                <td> {{ row.col3 | safe }} </td>
                                <td> {{ row.col4 | safe }} </td>
                                <td> {{ row.col5 | safe }} </td>
                            </tr>
                        {% endfor %}
                    {% endif %}
                </table>
            </div>
        </li>
        {% endwith %}
    {% endfor %}

    {% for accordion in accordionneo %}
        {% with identifier="accordionneo["|add:accordion.id|add:"]" %}
        <li data-id="{{ identifier }}">
            <div style="padding: 0.8em; margin: 0.5em; background: lightgray; border-radius: 7px;">
                <label><input 
                    ype ="checkbox" 
                    name="{{ identifier }}"
                    {% if identifier in entrySections %}checked="checked"{% endif %}
                    > Include Accordion</label>
                {% if accordion.accordionTitle != null %}
                    <h5>{{ accordion.accordionTitle }}</h5>
                {% endif %}
                {% for elem in accordion.accordionmatrix %}
                    <details>
                        <summary class= "{{ accordion.accordionClasses }}">{{ elem.accordionblocktitle }} </summary>
                        {{ elem.accordionblockcontent | safe }}
                    </details>
                {% endfor %}
            </div>
        </li>
        {% endwith %}
    {% endfor %}

</ul>
</form>
<span style="color: lightgrey; font-size: 9px; float: right;">GraphQL CMS XBlock v1.2</span>